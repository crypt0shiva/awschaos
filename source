local isAutoSlimeEnabled = false
local persistentIndex = nil
local pettoslime = "" -- Define pettoslime in a broader scope

-- Function to reset the persistent index
local function resetPersistentIndex()
    persistentIndex = nil
end

-- Function to check if the current pet index matches the persistent index
local function shouldReslime(currentIndex)
    return persistentIndex and currentIndex == persistentIndex
end

-- Main function to run the auto slimer
local function autoSlime()
    local Playerz = game:GetService("Players")
    local localPlayerz = Playerz.LocalPlayer

    repeat
        local args = {
            [1] = localPlayerz
        }

        local OwnedPets = game:GetService("ReplicatedStorage").Packages.Knit.Services.PetService.RF.getOwned:InvokeServer(unpack(args))

        if OwnedPets then
            for idx, pet in pairs(OwnedPets) do
                local displayName = pet.DisplayName
                local locked = pet.Locked
                local slime = pet.Slime
                local key = pet.Key
                local size = pet.CraftType

                if key == pettoslime and size == "Goliath" and slime ~= "Red" then
                    print("displayName:", pettoslime, "| Slime:", slime)

                    if slime == nil then 
                        local args = {
                            [1] = idx
                        }
                        game:GetService("ReplicatedStorage").Packages.Knit.Services.PetDeslimeService.RE.onPurchase:FireServer(unpack(args))
                        wait(.1)
                        game:GetService("ReplicatedStorage").Packages.Knit.Services.PetService.RF.slimify:InvokeServer(unpack(args))
                        print("Sliming...")
                        wait(1)
                        persistentIndex = idx
                    elseif slime ~= "Red" then
                        local args = {
                            [1] = idx
                        }

                        game:GetService("ReplicatedStorage").Packages.Knit.Services.PetDeslimeService.RE.onPurchase:FireServer(unpack(args))
                        print("Desliming...")

                        local countdown = 180
                        while countdown > 0 do
                            print("Remaining time:", countdown, "seconds")
                            wait(10)
                            countdown = countdown - 10
                        end
                        game:GetService("ReplicatedStorage").Packages.Knit.Services.PetDeslimeService.RE.onClaim:FireServer()
                    end
                elseif shouldReslime(idx) then
                    local args = {
                        [1] = idx
                    }

                    game:GetService("ReplicatedStorage").Packages.Knit.Services.PetService.RF.slimify:InvokeServer(unpack(args))
                    print("Resliming...")
                    wait(1)
                    resetPersistentIndex()
                else
                    -- Handle other cases or leave it empty if no specific action is needed.
                end
            end
        else
            print("OwnedPets is nil.")
        end
    until persistentIndex == nil
end

-- Function to toggle auto slimer
local function toggleAutoSlime()
    isAutoSlimeEnabled = not isAutoSlimeEnabled -- Toggle the state
    
    if isAutoSlimeEnabled then
        print("Auto Slime enabled!")
        autoSlime() -- Start the auto slime functionality
    else
        print("Auto Slime disabled.")
    end
end

---------------------------- GUI --------------------------------




local Finity = loadstring(game:HttpGet("https://raw.githubusercontent.com/LocalSmail/Finity/main/Library"))()

local FinityWindow = Finity.new("Arm Wrestling Simulator Admin Menu", true, false, "", true, "")

local AutoFarmCategory = FinityWindow:Category("Auto-Farm")

local AutoFarmSettings = AutoFarmCategory:Sector("Plant and Harvest") -- Adds sections inside the category, Name Optional

AutoFarmSettings:Cheat("dropdown", "Seeds", function(seeds)
    print(seeds)
end, { options = {"Apple", "Banana", "DragonFruit","Pear"}, default = "Apple" })

local AutoSlimeCategory = FinityWindow:Category("Auto-Slime")

local AutoSlimeSettings = AutoSlimeCategory:Sector("Enter Pet Name") -- Adds sections inside the category, Name Optional
local SlimePetName = AutoSlimeSettings:Cheat("Textbox", "Pet Name", function(petslimeinput)
    pettoslime = petslimeinput -- Set the global variable pettoslime
    print(pettoslime)
end, { placeholder = "Dominus" })

AutoSlimeSettings:Cheat("Checkbox", "Toggle AutoSlime", toggleAutoSlime)

---------------------------- GUI --------------------------------





